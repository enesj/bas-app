// Compiled by ClojureScript 1.10.339 {}
goog.provide('basapp.ui.departments');
goog.require('cljs.core');
goog.require('keechma.ui_component');
goog.require('keechma.toolbox.ui');
goog.require('basapp.datascript');
goog.require('basapp.ui.inputs');
goog.require('keechma.toolbox.forms.ui');
goog.require('antizer.reagent');
goog.require('reagent.core');
goog.require('keechma.toolbox.pipeline.core');
goog.require('keechma.toolbox.forms.core');
basapp.ui.departments.comparison = (function basapp$ui$departments$comparison(data1,data2,field){
return cljs.core.compare.call(null,cljs.core.get.call(null,cljs.core.js__GT_clj.call(null,data1,new cljs.core.Keyword(null,"keywordize-keys","keywordize-keys",1310784252),true),field),cljs.core.get.call(null,cljs.core.js__GT_clj.call(null,data2,new cljs.core.Keyword(null,"keywordize-keys","keywordize-keys",1310784252),true),field));
});
basapp.ui.departments.columns = (function basapp$ui$departments$columns(ctx,data){
return new cljs.core.PersistentVector(null, 4, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.PersistentArrayMap(null, 4, [new cljs.core.Keyword(null,"title","title",636505583),"Ime",new cljs.core.Keyword(null,"dataIndex","dataIndex",778447901),"name",new cljs.core.Keyword(null,"sorter","sorter",-2066997708),(function (p1__33608_SHARP_,p2__33609_SHARP_){
return basapp.ui.departments.comparison.call(null,p1__33608_SHARP_,p2__33609_SHARP_,new cljs.core.Keyword(null,"name","name",1843675177));
}),new cljs.core.Keyword(null,"render","render",-1408033454),(function (p1__33611_SHARP_,p2__33610_SHARP_){
return reagent.core.as_element.call(null,new cljs.core.PersistentVector(null, 3, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword(null,"a","a",-2123407586),new cljs.core.PersistentArrayMap(null, 1, [new cljs.core.Keyword(null,"href","href",-793805698),keechma.ui_component.url.call(null,ctx,new cljs.core.PersistentArrayMap(null, 2, [new cljs.core.Keyword(null,"page","page",849072397),"departments",new cljs.core.Keyword(null,"id","id",-1388402092),cljs.core.js__GT_clj.call(null,p2__33610_SHARP_).call(null,"id")], null))], null),p1__33611_SHARP_], null));
})], null),new cljs.core.PersistentArrayMap(null, 3, [new cljs.core.Keyword(null,"title","title",636505583),"Oznaka",new cljs.core.Keyword(null,"dataIndex","dataIndex",778447901),"short-name",new cljs.core.Keyword(null,"sorter","sorter",-2066997708),(function (p1__33612_SHARP_,p2__33613_SHARP_){
return basapp.ui.departments.comparison.call(null,p1__33612_SHARP_,p2__33613_SHARP_,new cljs.core.Keyword(null,"short-name","short-name",-1767085022));
})], null),new cljs.core.PersistentArrayMap(null, 4, [new cljs.core.Keyword(null,"title","title",636505583),"Sektor",new cljs.core.Keyword(null,"dataIndex","dataIndex",778447901),"sektor",new cljs.core.Keyword(null,"sorter","sorter",-2066997708),(function (p1__33614_SHARP_,p2__33615_SHARP_){
return basapp.ui.departments.comparison.call(null,p1__33614_SHARP_,p2__33615_SHARP_,new cljs.core.Keyword(null,"sektor","sektor",-2002951071));
}),new cljs.core.Keyword(null,"render","render",-1408033454),(function (p1__33616_SHARP_){
return reagent.core.as_element.call(null,new cljs.core.Keyword("sector","short-name","sector/short-name",1286264128).cljs$core$IFn$_invoke$arity$1(cljs.core.first.call(null,cljs.core.filter.call(null,(function (x){
return cljs.core._EQ_.call(null,new cljs.core.Keyword("db","id","db/id",-1388397098).cljs$core$IFn$_invoke$arity$1(x),p1__33616_SHARP_);
}),new cljs.core.Keyword(null,"sectors","sectors",-1244148731).cljs$core$IFn$_invoke$arity$1(data)))));
})], null),new cljs.core.PersistentArrayMap(null, 6, [new cljs.core.Keyword(null,"title","title",636505583),"Aktivan",new cljs.core.Keyword(null,"dataIndex","dataIndex",778447901),"active",new cljs.core.Keyword(null,"sorter","sorter",-2066997708),(function (p1__33617_SHARP_,p2__33618_SHARP_){
return basapp.ui.departments.comparison.call(null,p1__33617_SHARP_,p2__33618_SHARP_,new cljs.core.Keyword(null,"active","active",1895962068));
}),new cljs.core.Keyword(null,"filters","filters",974726919),new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.PersistentArrayMap(null, 2, [new cljs.core.Keyword(null,"text","text",-1790561697),"Da",new cljs.core.Keyword(null,"value","value",305978217),true], null),new cljs.core.PersistentArrayMap(null, 2, [new cljs.core.Keyword(null,"text","text",-1790561697),"Ne",new cljs.core.Keyword(null,"value","value",305978217),false], null)], null),new cljs.core.Keyword(null,"onFilter","onFilter",-791374537),(function (value,record){
return cljs.core._EQ_.call(null,[cljs.core.str.cljs$core$IFn$_invoke$arity$1(record.active)].join(''),value);
}),new cljs.core.Keyword(null,"render","render",-1408033454),(function (p1__33619_SHARP_){
return reagent.core.as_element.call(null,new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword(null,"div","div",1057191632),(cljs.core.truth_(p1__33619_SHARP_)?"Da":"Ne")], null));
})], null)], null);
});
basapp.ui.departments.pagination = new cljs.core.PersistentArrayMap(null, 3, [new cljs.core.Keyword(null,"show-size-changer","show-size-changer",-745395013),true,new cljs.core.Keyword(null,"page-size-options","page-size-options",-1390274615),new cljs.core.PersistentVector(null, 3, 5, cljs.core.PersistentVector.EMPTY_NODE, ["5","10","20"], null),new cljs.core.Keyword(null,"show-total","show-total",-237443507),(function (p1__33620_SHARP_){
return ["Ukupno: ",cljs.core.str.cljs$core$IFn$_invoke$arity$1(p1__33620_SHARP_)," odjeljenja"].join('');
})], null);
basapp.ui.departments.departments_table = (function basapp$ui$departments$departments_table(ctx,data){
var departments = basapp.datascript.q_GT_.call(null,ctx,new cljs.core.PersistentVector(null, 6, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword(null,"find","find",496279456),new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [cljs.core.list(new cljs.core.Symbol(null,"pull","pull",779986722,null),new cljs.core.Symbol(null,"?e","?e",-1194391683,null),new cljs.core.PersistentVector(null, 1, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Symbol(null,"*","*",345799209,null)], null)),new cljs.core.Symbol(null,"...","...",-1926939749,null)], null),new cljs.core.Keyword(null,"in","in",-1531184865),new cljs.core.Symbol(null,"$","$",-1580747756,null),new cljs.core.Keyword(null,"where","where",-2044795965),new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Symbol(null,"?e","?e",-1194391683,null),new cljs.core.Keyword("department","short-name","department/short-name",1711124852)], null)], null));
return new cljs.core.PersistentVector(null, 3, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword(null,"div","div",1057191632),new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword(null,"h2","h2",-372662728),"Odjeljenja"], null),new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [antizer.reagent.table,new cljs.core.PersistentArrayMap(null, 5, [new cljs.core.Keyword(null,"columns","columns",1998437288),basapp.ui.departments.columns.call(null,ctx,data),new cljs.core.Keyword(null,"dataSource","dataSource",-178401132),departments,new cljs.core.Keyword(null,"pagination","pagination",-1553654604),basapp.ui.departments.pagination,new cljs.core.Keyword(null,"row-key","row-key",-1189010712),"id",new cljs.core.Keyword(null,"row-selection","row-selection",1964656498),new cljs.core.PersistentArrayMap(null, 1, [new cljs.core.Keyword(null,"on-change","on-change",-732046149),((function (departments){
return (function (p1__33622_SHARP_,p2__33621_SHARP_){
var selected = cljs.core.js__GT_clj.call(null,p2__33621_SHARP_,new cljs.core.Keyword(null,"keywordize-keys","keywordize-keys",1310784252),true);
keechma.toolbox.ui._LT_cmd.call(null,ctx,new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword(null,"user-actions","user-actions",1950728499),new cljs.core.Keyword(null,"employees-filter","employees-filter",-2138121844)], null),new cljs.core.PersistentArrayMap(null, 1, [new cljs.core.Keyword(null,"departments","departments",799278298),new cljs.core.Keyword(null,"id","id",-1388402092).cljs$core$IFn$_invoke$arity$1(cljs.core.first.call(null,selected))], null));

return antizer.reagent.message_info.call(null,["Izabrali ste: ",cljs.core.str.cljs$core$IFn$_invoke$arity$1(cljs.core.map.call(null,new cljs.core.Keyword(null,"name","name",1843675177),selected))].join(''));
});})(departments))
], null)], null)], null)], null);
});
basapp.ui.departments.render_form_errors = (function basapp$ui$departments$render_form_errors(ctx,form_props){
var form_state = keechma.toolbox.forms.ui.form_state_GT_.call(null,ctx,form_props);
if(cljs.core._EQ_.call(null,new cljs.core.Keyword(null,"submit-failed","submit-failed",252220857),cljs.core.get_in.call(null,form_state,new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword(null,"state","state",-1988618099),new cljs.core.Keyword(null,"type","type",1174270348)], null)))){
var e = cljs.core.ex_message.call(null,cljs.core.get_in.call(null,form_state,new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword(null,"state","state",-1988618099),new cljs.core.Keyword(null,"cause","cause",231901252)], null)));
return new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword(null,"div.alert.alert-danger","div.alert.alert-danger",-890058301),e], null);
} else {
return null;
}
});
basapp.ui.departments.render_form = (function basapp$ui$departments$render_form(ctx,title,data){
var form_props = new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword(null,"department","department",-359157087),new cljs.core.Keyword(null,"form","form",-1624062471)], null);
return new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword(null,"div.card-body","div.card-body",1538579065),new cljs.core.PersistentVector(null, 8, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword(null,"form","form",-1624062471),new cljs.core.PersistentArrayMap(null, 1, [new cljs.core.Keyword(null,"on-submit","on-submit",1227871159),((function (form_props){
return (function (p1__33623_SHARP_){
return keechma.toolbox.forms.ui._LT_submit.call(null,ctx,form_props,p1__33623_SHARP_);
});})(form_props))
], null),new cljs.core.PersistentVector(null, 3, 5, cljs.core.PersistentVector.EMPTY_NODE, [basapp.ui.departments.render_form_errors,ctx,form_props], null),new cljs.core.PersistentVector(null, 5, 5, cljs.core.PersistentVector.EMPTY_NODE, [basapp.ui.inputs.text,ctx,form_props,new cljs.core.Keyword(null,"short-name","short-name",-1767085022),new cljs.core.PersistentArrayMap(null, 2, [new cljs.core.Keyword(null,"placeholder","placeholder",-104873083),"Oznaka",new cljs.core.Keyword(null,"disabled","disabled",-1529784218),cljs.core.not_EQ_.call(null,new cljs.core.Keyword(null,"id","id",-1388402092).cljs$core$IFn$_invoke$arity$1(data),(0))], null)], null),new cljs.core.PersistentVector(null, 5, 5, cljs.core.PersistentVector.EMPTY_NODE, [basapp.ui.inputs.text,ctx,form_props,new cljs.core.Keyword(null,"name","name",1843675177),new cljs.core.PersistentArrayMap(null, 1, [new cljs.core.Keyword(null,"placeholder","placeholder",-104873083),"Ime"], null)], null),new cljs.core.PersistentVector(null, 5, 5, cljs.core.PersistentVector.EMPTY_NODE, [basapp.ui.inputs.select,ctx,form_props,new cljs.core.Keyword(null,"sector","sector",-1444247062),new cljs.core.PersistentArrayMap(null, 2, [new cljs.core.Keyword(null,"options","options",99638489),cljs.core.mapv.call(null,((function (form_props){
return (function (r){
return new cljs.core.PersistentArrayMap(null, 2, [new cljs.core.Keyword(null,"value","value",305978217),new cljs.core.Keyword("db","id","db/id",-1388397098).cljs$core$IFn$_invoke$arity$1(r),new cljs.core.Keyword(null,"label","label",1718410804),new cljs.core.Keyword("sector","short-name","sector/short-name",1286264128).cljs$core$IFn$_invoke$arity$1(r)], null);
});})(form_props))
,new cljs.core.Keyword(null,"sectors","sectors",-1244148731).cljs$core$IFn$_invoke$arity$1(data)),new cljs.core.Keyword(null,"label","label",1718410804),"Sektor"], null)], null),new cljs.core.PersistentVector(null, 5, 5, cljs.core.PersistentVector.EMPTY_NODE, [basapp.ui.inputs.checkbox,ctx,form_props,new cljs.core.Keyword(null,"active","active",1895962068),new cljs.core.PersistentArrayMap(null, 1, [new cljs.core.Keyword(null,"label","label",1718410804),"Aktivan"], null)], null),new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword(null,"button.btn.btn-primary","button.btn.btn-primary",510358192),"Snimi"], null)], null)], null);
});
basapp.ui.departments.render = (function basapp$ui$departments$render(ctx){
var selection = cljs.core.atom.call(null,cljs.core.List.EMPTY);
var department_id = new cljs.core.Keyword(null,"id","id",-1388402092).cljs$core$IFn$_invoke$arity$1(keechma.toolbox.ui.route_GT_.call(null,ctx));
var department_title = ((cljs.core._EQ_.call(null,department_id,(0)))?new cljs.core.PersistentArrayMap(null, 2, [new cljs.core.Keyword("department","name","department/name",-1151724673),"Novo",new cljs.core.Keyword("department","short-name","department/short-name",1711124852),"odjeljenje"], null):(((department_id > (0)))?basapp.datascript.entity_GT_.call(null,ctx,department_id):null
));
var data = new cljs.core.PersistentArrayMap(null, 4, [new cljs.core.Keyword(null,"sectors","sectors",-1244148731),basapp.datascript.q_GT_.call(null,ctx,new cljs.core.PersistentVector(null, 6, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword(null,"find","find",496279456),new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [cljs.core.list(new cljs.core.Symbol(null,"pull","pull",779986722,null),new cljs.core.Symbol(null,"?e","?e",-1194391683,null),new cljs.core.PersistentVector(null, 1, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Symbol(null,"*","*",345799209,null)], null)),new cljs.core.Symbol(null,"...","...",-1926939749,null)], null),new cljs.core.Keyword(null,"in","in",-1531184865),new cljs.core.Symbol(null,"$","$",-1580747756,null),new cljs.core.Keyword(null,"where","where",-2044795965),new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Symbol(null,"?e","?e",-1194391683,null),new cljs.core.Keyword("sector","short-name","sector/short-name",1286264128)], null)], null)),new cljs.core.Keyword(null,"departments","departments",799278298),basapp.datascript.q_GT_.call(null,ctx,new cljs.core.PersistentVector(null, 6, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword(null,"find","find",496279456),new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [cljs.core.list(new cljs.core.Symbol(null,"pull","pull",779986722,null),new cljs.core.Symbol(null,"?e","?e",-1194391683,null),new cljs.core.PersistentVector(null, 1, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Symbol(null,"*","*",345799209,null)], null)),new cljs.core.Symbol(null,"...","...",-1926939749,null)], null),new cljs.core.Keyword(null,"in","in",-1531184865),new cljs.core.Symbol(null,"$","$",-1580747756,null),new cljs.core.Keyword(null,"where","where",-2044795965),new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Symbol(null,"?e","?e",-1194391683,null),new cljs.core.Keyword("department","short-name","department/short-name",1711124852)], null)], null)),new cljs.core.Keyword(null,"id","id",-1388402092),department_id,new cljs.core.Keyword(null,"selection","selection",975998651),selection], null);
return new cljs.core.PersistentVector(null, 5, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword(null,"div.container.pt-5","div.container.pt-5",734167348),new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword(null,"p.mb-5","p.mb-5",1561333168),new cljs.core.PersistentVector(null, 3, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword(null,"a","a",-2123407586),new cljs.core.PersistentArrayMap(null, 1, [new cljs.core.Keyword(null,"href","href",-793805698),keechma.ui_component.url.call(null,ctx,new cljs.core.PersistentArrayMap(null, 1, [new cljs.core.Keyword(null,"page","page",849072397),"dashboard"], null))], null),"\u2190 Povratak na naslovnicu"], null)], null),new cljs.core.PersistentVector(null, 3, 5, cljs.core.PersistentVector.EMPTY_NODE, [basapp.ui.departments.departments_table,ctx,data], null),(cljs.core.truth_(new cljs.core.Keyword("department","name","department/name",-1151724673).cljs$core$IFn$_invoke$arity$1(department_title))?(function (){
keechma.toolbox.forms.ui._LT_call.call(null,ctx,new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword(null,"department","department",-359157087),new cljs.core.Keyword(null,"form","form",-1624062471)], null),new cljs.core.Keyword(null,"reset-form","reset-form",620246626));

return new cljs.core.PersistentVector(null, 3, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword(null,"div.container.pt-5","div.container.pt-5",734167348),new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword(null,"h3","h3",2067611163),[cljs.core.str.cljs$core$IFn$_invoke$arity$1(new cljs.core.Keyword("department","name","department/name",-1151724673).cljs$core$IFn$_invoke$arity$1(department_title))," ",cljs.core.str.cljs$core$IFn$_invoke$arity$1(new cljs.core.Keyword("department","short-name","department/short-name",1711124852).cljs$core$IFn$_invoke$arity$1(department_title))].join('')], null),new cljs.core.PersistentVector(null, 4, 5, cljs.core.PersistentVector.EMPTY_NODE, [basapp.ui.departments.render_form,ctx,"",data], null)], null);
})()
:null),((cljs.core.empty_QMARK_.call(null,cljs.core.deref.call(null,selection)))?new cljs.core.PersistentVector(null, 1, 5, cljs.core.PersistentVector.EMPTY_NODE, [keechma.ui_component.component.call(null,ctx,new cljs.core.Keyword(null,"employees","employees",1002695450))], null):null)], null);
});
basapp.ui.departments.component = keechma.ui_component.constructor$.call(null,new cljs.core.PersistentArrayMap(null, 3, [new cljs.core.Keyword(null,"renderer","renderer",336841071),basapp.ui.departments.render,new cljs.core.Keyword(null,"subscription-deps","subscription-deps",1798032321),new cljs.core.PersistentVector(null, 1, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword(null,"datascript","datascript",-2114593819)], null),new cljs.core.Keyword(null,"component-deps","component-deps",-405716162),new cljs.core.PersistentVector(null, 1, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword(null,"employees","employees",1002695450)], null)], null));

//# sourceMappingURL=departments.js.map?rel=1563556259654
